こんばんは。あなたは優秀なソフトウェア技術者です。
自己学習用の初歩的な、組み込みLinuxのカーネルモジュールの開発を手伝ってください。
作成するネットワーク通信用カーネルモジュールの仕様は次の通りです。

送信側モジュール名：send_module
受信側モジュール名：receive_module
動作仕様：
IPV4 専用のTCP socket の単純な片方向の、Linux ローダブルモジュール、送信(send) と受信(receive)のそれぞれの専用のローダブルモジュール2種類のコードとして作成します。
データ長は最大4GBととして、メモリーでバッファします。プログラム内部では起動時にこの4GB固定のバッファ領域を送信側と受信側、それぞれが持ちます。
送信側も受信側も、dataという名前のモジュールパラメータを持ち、それぞれ module_param_cb() のコールバック関数で機能を実装します。
送信側は、データ入力用に sysfsの/sys/modules/send_module/parameters/dataという名前のモジュールパラメータのエントリーを持ち、その「data」へのユーザ入力が完了すると送信を開始します。
ユーザ入力は、ユーザのバイナリーデータの受信で開始します。この時にTCP/IPコネクションを確立し、データを受信しながら接続先にデータ送信します。
最大値の4GBか、または5秒間データが途切れると入力完了し、コネクションを閉じて、データ待ち状態になります。
受信側は起動後、sysfsの/sys/modules/send_module/parameters/dataという名前のパラメータで、ずっとコネクションとそれに続くデータ受信を待ち受けしてして、データ到着で受信を開始し、コネクションがCloseされると入力を完了します。
受信側がデータ受信したデータを内部のバッファに貯めますが、受信中でもユーザがsysfsパラメータを読み出した場合は、FIFOの様に受信したデータをユーザ空間に出力します。
コネクションのCloseかまたは、最大値の4GB受信で受信を完了してコネクションを切断します。その後は、コネクション待ちとなります。
既存のLinux TCP/IP socketのヘッダーを使用しますが、全てのTCP/IP通信動作をカーネルモードで動作するローダブルモジュールとして実装する必要があることに注意します。

送信先のIPアドレスは送信側だけが、sysfsの"ip"という名前の文字列型のモジュールパラメータで、IPアドレスを示す"255.255.255.255"形式のパラメータで持ち、デフォルトは"127.0.0.1"です。
送信側も受信側も使用するIPポートは 4444 固定、同一サブネット内だけでの通信で、DNSとルーティングは使用しません。複数コネクションの接続と、動作中の"ip"パラメータの変更は考慮しません。
送信側、受信側ともに int 型の debug というモジュールパラメータを付加します。
この debug パラメータの値が 0 ではない場合に、printk で各内部関数の実行時と、エラー発生で戻る部分にデバッグ用メッセージを出力する処理を追加します。
デバッグ用メッセージは特に、socket送信での送受信データのサイズとリターン値を表示する様にします。
質問があれば、教えてください。
